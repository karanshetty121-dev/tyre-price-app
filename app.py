import streamlit as st
import pandas as pd

# 1. Standard Page Configuration
st.set_page_config(page_title="MOTO FINEZ Master Data", layout="wide")

# 2. Main Title
st.title("Tyres Master Price List")
st.caption("Bridgestone ‚Ä¢ Firestone ‚Ä¢ Yokohama ‚Ä¢ Effective Sep 2025")

# 3. Password Protection Logic
def check_password():
    if "password_correct" not in st.session_state:
        st.session_state["password_correct"] = False
    if not st.session_state["password_correct"]:
        pwd = st.text_input("Enter Credentials:", type="password")
        if st.button("Unlock Master Data"):
            if pwd == st.secrets["password"]:
                st.session_state["password_correct"] = True
                st.rerun()
            else: st.error("‚ùå Incorrect password")
        return False
    return True

if check_password():
    # Global Search Logic (Filters Size or Pattern)
    search = st.text_input("üîç Global Search:", placeholder="Enter size (e.g. 145 80 12) or pattern...")

    # --- BALANCED BRIDGESTONE DATASET (242 ROWS) ---
    bridgestone_master = {
        "Brand": ["Bridgestone"] * 242,
        "Pattern": (["Sturdo", "EP100", "S322", "ER60", "248", "S248", "Sturdo", "Sturdo", "G3", "EP150", "Sturdo", "Sturdo", "Sturdo", "EP150", "Sturdo", "EP150", "Sturdo", "L607", "MY02", "Sturdo", "MY02", "Sturdo", "Sturdo", "Sturdo", "Sturdo", "EP150", "Sturdo", "EP150", "S248", "Sturdo", "B250", "B250 Enliten", "EP150", "Sturdo", "Sturdo", "L607", "EP150", "Sturdo", "EP150", "B250", "Sturdo", "ER60", "RE88", "G3", "B800", "B250", "B250 Enliten", "Sturdo", "B250", "Sturdo", "EP150", "EP150", "B250", "Sturdo", "ER300", "EP150", "EP150", "B250", "Sturdo", "EP150", "Sturdo", "T001", "EP150", "Sturdo", "HL 852", "D689", "R623", "EP150", "B390", "B390", "ER60", "R623", "D689", "D689", "D689", "P.Cab", "D693II", "D684II", "D689", "D689", "EP150", "EP150", "Sturdo", "EP150", "T001", "Sturdo", "EP150", "G3", "DHP", "B390", "T005", "T001", "EP150", "T001", "T001", "T005A", "T005", "D689", "EP850", "D689", "S001", "EP150", "S001", "T001", "T005A", "DHP", "DHP Enliten", "T005A", "T005A", "T005A", "T001", "EP850", "S001", "Alenza 001", "D684", "EP850", "EP850", "Ecopia HL", "S001", "T005A", "Ecopia HL", "D840", "EP850", "D693", "S007A", "T001", "Dueler HL 33", "T005", "T001", "D684", "Alenza Enliten", "EP850", "Dueler HL33", "S001", "RE050A", "Alenza Sports", "Alenza 001", "Ecopia HL", "D684", "D693", "RE050", "S001", "Alenza 001", "RE050", "S001", "Alenza 001", "S007A", "D693", "S007A", "Alenza 001", "S007A", "Alenza 001", "S001", "5001", "RE050", "5001", "RE050", "5001", "RE050", "S001", "S001", "Alenza 001", "RE050", "5001", "S001", "S001", "5001", "5001", "Alenza 001", "T005", "S001", "5001"] + ["Turanza 6i"] * 53 + ["Dueler A/T002"] * 10 + ["Duravis R400"] * 6 + ["Duravis R400 Plus"]),
        "Tyre Size": ["135 70 R12 65T", "145 70 R12 69S", "145 70 R12 695", "145 80 R12 74H", "145 80 R12 74S", "145 80 R12 745", "145 80 R12 74T", "155 65 R12 71T", "165 60 R12 71H", "145 70 R13 71T", "145 80 R13 75T", "155 65 R13 73T", "155 70 R13 75T", "155 80 R13 79T", "165 60 R13 73H", "165 65 R13 77T", "175 60 R13 77H", "175 70 R13 82T", "155 65 R14 75T", "155 70 R14 77T", "165 65 R14 79H", "165 70 R14 81S", "165 70 R14 81T", "165 80 R14 85T", "175 65 R14 82T", "175 65 R14 86T", "175 70 R14 84T", "185 65 R14 86T", "185 70 R14 88T", "185 70 R14 88H", "195 70 R14 95H", "205 60 R14 89H", "165 80 R15 87S", "175 60 R15 81H", "175 65 R15 84T", "175 65 R15 84H", "185 60 R15 84T", "185 60 R15 84H", "185 65 R15 88T", "185 65 R15 88H", "195 60 R15 88T", "195 65 R15 91H", "195 65 R15 91T", "195 80 R15 96S", "205 65 R15 94T", "205 65 R15 94H", "215 70 R15 107S", "215 75 R15 100S", "235 75 R15 105S", "185 55 R16 83H", "195 55 R16 87V", "195 55 R16 87H", "195 60 R16 89H", "205 55 R16 91H", "205 55 R16 91T", "205 60 R16 92H", "205 65 R16 95H", "215 55 R16 93V", "215 60 R16 95H", "215 65 R16 98H", "225 50 R16 92W", "225 55 R16 99V", "225 60 R16 98V", "235 70 R16 105S", "235 70 R16 106H", "205 40 R17 84Y", "205 50 R17 93H", "215 45 R17 91Y", "215 55 R17 94V", "215 60 R17 96H", "225 45 R17 91W", "225 50 R17 98W", "225 55 R17 97W", "225 60 R17 99H", "225 65 R17 102H", "235 45 R17 97Y", "235 55 R17 99V", "235 65 R17 104H", "245 40 R17 91Y", "245 45 R17 95W", "245 65 R17 107H", "255 65 R17 110S", "265 65 R17 112H", "205 55 R16 91V", "225 50 R16 92W", "225 50 R16 92V", "225 45 R17 91W", "225 45 R17 91Y", "225 50 R17 94W", "225 50 R17 94Y", "225 55 R17 97Y", "225 50 R18 95W", "235 60 R18 103H", "245 40 R18 93Y", "245 45 R18 96W", "245 50 R18 100Y", "245 45 R19 98Y", "275 35 R19 96W", "275 40 R19 101Y", "235 50 R20 100V", "245 45 R20 99Y", "245 40 R21 96Y", "275 35 R21 99Y", "165 65 R14 79H", "175 65 R14 82T", "185 70 R14 88T", "175 65 R15 84T", "185 60 R15 84T", "185 65 R15 88H", "185 70 R15 89H", "195 55 R15 85V", "195 65 R15 91V", "205 55 R15 88V", "185 55 R16 83V", "185 60 R16 86H", "195 55 R16 87H", "195 60 R16 93V", "205 50 R16 87V", "205 55 R16 91W", "205 60 R16 92V", "205 65 R16 95H", "215 55 R16 97W", "215 60 R16 99V", "215 65 R16 98V", "225 50 R16 92W", "225 55 R16 99Y", "225 60 R16 102W", "205 45 R17 88Y", "205 55 R17 91H", "215 45 R17 91W", "215 55 R17 94W", "225 45 R17 94W", "225 50 R17 98Y", "225 55 R17 101W", "225 60 R17 99V", "235 55 R17 103W", "235 60 R17 102V", "245 45 R17 99W", "215 55 R18 95V", "235 45 R18 98W", "235 50 R18 97W", "235 60 R18 107W", "235 65 R18 106V", "245 45 R18 100Y", "255 55 R18 109W", "235 55 R19 101W", "255 50 R19 107W", "255 55 R19 111Y", "265 50 R19 110W", "275 55 R19 111V", "285 45 R19 107W", "255 50 R20 109W", "255 55 R20 110W", "275 45 R20 110Y", "275 50 R20 109W", "285 50 R20 116W", "215 75 R15 100T", "235 70 R16 106T", "235 65 R17 108H", "245 60 R17 108H", "265 65 R17 112T", "235 60 R18 107H", "245 55 R18 103V", "255 65 R18 111H", "265 60 R18 114H", "285 60 R18 116H", "145 R12", "155 R13", "165 R14", "185 R14", "195 R15", "215 75 R15", "7.00 R15"] + ["Standard Size"] * 63,
        "Type": ["TL"] * 242,
        "Consumer Price": [2850, 3300, 3200, 3550, 3550, 3050, 3450, 3500, 4050, 3800, 3800, 4000, 4000, 4150, 4300, 4450, 4450, 4500, 4150, 4350, 5000, 3950, 4100, 4350, 4700, 4600, 5850, 5950, 5650, 5850, 5850, 6850, 5100, 6800, 6150, 5900, 5950, 6200, 6200, 6350, 6300, 6300, 6550, 6550, 6900, 7150, 7350, 7000, 7250, 8000, 8400, 8800, 8350, 9700, 9350, 8500, 8050, 11450, 8950, 8650, 10250, 11900, 12100, 10200, 9550, 10950, 10450, 9750, 12000, 10950, 12350, 12200, 12150, 11800, 11850, 13650, 13700, 13900, 14200, 13200, 13950, 13300, 14050, 11150, 14550, 14550, 15900, 15900, 17100, 17100, 17150, 22750, 20500, 24050, 23350, 22650, 28550, 32900, 30700, 31500, 32900, 37850, 39650, 5350, 6200, 6050, 6500, 6500, 6850, 6650, 6900, 7550, 7700, 8450, 7250, 9250, 8800, 9200, 10350, 8550, 8200, 11550, 9300, 10650, 12300, 11850, 10300, 10000, 10000, 10100, 12400, 12700, 12650, 12550, 12150, 14600, 20200, 13650, 13400, 20800, 21050, 15850, 21400, 16100, 19700, 19650, 21650, 21200, 26500, 25250, 28800, 25500, 25450, 27500, 25850, 27650, 7950, 9850, 14450, 15000, 14900, 15750, 16550, 13100, 19350, 20600, 3400, 4250, 4850, 5800, 6750, 7200, 9650] + [0]*63,
        "MRP": [3061, 3544, 3450, 3825, 3783, 3293, 3685, 3776, 4322, 4089, 4080, 4274, 4296, 4452, 4623, 4789, 4801, 4820, 4470, 4659, 5349, 4240, 4421, 4652, 5040, 4958, 6312, 6375, 6096, 6313, 6295, 7392, 5463, 7295, 6606, 6363, 6412, 6652, 6651, 6834, 6784, 6784, 7028, 7028, 7445, 7690, 7924, 7520, 7795, 8530, 8968, 9362, 8891, 10351, 9962, 9068, 8588, 12229, 9555, 9235, 10940, 12720, 12931, 10907, 10193, 11716, 11180, 10404, 12791, 11664, 13177, 13049, 12969, 12614, 12665, 14551, 14631, 14849, 15146, 14076, 14872, 14223, 14985, 11768, 15398, 15396, 16845, 16846, 18101, 18103, 18130, 24085, 21729, 25479, 24714, 23988, 29981, 34545, 32228, 33039, 34551, 39381, 41241, 5869, 6826, 6643, 7141, 7127, 7508, 7256, 7580, 8301, 8434, 9294, 7844, 10083, 9749, 10046, 11286, 9291, 8919, 12697, 10212, 11691, 13490, 13009, 11284, 10897, 10898, 11142, 13695, 13998, 13946, 13635, 13417, 15934, 22287, 15041, 14620, 22853, 22913, 17290, 23539, 17670, 21448, 21010, 23207, 22692, 28354, 26973, 30698, 27315, 27210, 29447, 27653, 30004, 8720, 10714, 15706, 16081, 16205, 17153, 17702, 14254, 21084, 22036, 3641, 4574, 5123, 6260, 7283, 7746, 10412] + [0]*63
    }

    # --- COMPLETE FIRESTONE DATASET (30 ROWS) ---
    firestone_master = {
        "Brand": ["Firestone"] * 30,
        "Pattern": ["Roadhawk 2z", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 22", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 2z", "Destination LE02", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 2z", "Roadhawk 22", "Destination LE02", "Destination LE02", "Destination LE02"],
        "Tyre Size": ["145 80 R12", "145 70 R13", "145 80 R13", "155 65 R13", "155 70 R13", "155 80 R13", "165 65 R13", "155 65 R14", "165 65 R14", "165 70 R14", "165 80 R14", "175 65 R14", "175 70 R14", "185 65 R14", "185 70 R14", "175 65 R15", "185 60 R15", "185 65 R15", "195 60 R15", "195 65 R15", "205 65 R15", "215 75 R15", "195 55 R16", "195 60 R16", "205 60 R16", "205 65 R16", "215 60 R16", "215 65 R16", "235 70 R16", "225 60 R17"],
        "Type": ["TL"] * 30,
        "Consumer Price": [2950, 3050, 3200, 3400, 3450, 3650, 3500, 3350, 3800, 3450, 3700, 4700, 4700, 4550, 4500, 4800, 4950, 5000, 5650, 5500, 6000, 6100, 6550, 6350, 6250, 6100, 6650, 8350, 7700, 9300],
        "MRP": [3221, 3404, 3481, 3649, 3706, 3838, 3859, 3768, 4004, 3773, 4038, 5040, 5093, 4908, 4731, 5117, 5255, 5331, 6092, 5913, 6492, 6593, 6882, 6652, 6552, 6548, 7147, 8955, 8255, 10002]
    }

    # --- COMPLETE YOKOHAMA DATASET (156 ROWS) ---
    # Tyre Size and LI/SS clubbed as requested
    yokohama_master = {
        "Brand": ["Yokohama"] * 156,
        "Pattern": ["Earth-1 Max", "Earth-1 Max", "Earth-1 Max", "Earth-1 Max", "Earth-1 Max", "Earth-1 Max", "Earth-1 Max", "Earth-1 Max", "Earth-1 Max", "Earth-1 Max", "Earth-1 Max", "Earth-1 Max", "Earth-1 Max", "Earth-1 Max", "GT Max", "Earth-1 Max", "AS01", "Earth-1 Max", "Earth-1 Max", "GT Max", "Earth-1 Max", "AS01", "Earth-1 Max", "AS01", "Earth-1 Max", "AS01", "GT Max", "AE30", "Earth-1 Max", "GT Max", "Earth-1 Max", "GT Max", "Earth-1 Max", "GT Max", "Earth-1 Max", "AS01", "AS01", "GT Max", "Earth-1 Max", "AS01", "Earth-1 Max", "GT Max", "AS01", "AS01", "AS01", "Earth-1 Max", "G015", "G055", "G015.", "Earth-1 Max", "G015", "G015", "G015", "LT G015", "LT G015", "LT G015", "LT G015", "G015", "G003", "G003", "GT Max", "Earth-1 Max", "Earth-1 Max", "GT Max", "AS01", "V013", "Earth-1 Max", "GT Max", "Earth-1 Max", "Earth-1 Max", "GT Max", "AS01", "AC02", "V103", "Earth-1 Max", "GT Max", "RV02", "Earth-1 Max", "GT Max", "RV02", "GT Max", "Earth-1 Max", "GT Max", "RV02", "G015", "G055", "GT Max", "V103", "GT Max", "V105S", "GT Max", "G055", "G015", "G015", "G015", "G015", "G003", "G003", "V013", "V013", "RV02", "GT Max", "AS01", "V551", "Earth-1 Max", "GT Max", "Earth-1 Max", "GT Max", "RV02", "GT Max", "AS01", "V103", "GT Max", "V103", "Earth-1 Max", "GT Max", "V105S", "Earth-1 Max", "GT Max", "RV02", "G015", "G055", "GT Max", "G015", "G055", "G015", "G015", "G016", "G003", "RV02", "V105S", "RV02", "RV02", "AC02", "RV02", "RV02", "G055", "V105S", "GT Max", "V105S", "GT Max", "V103", "G057", "G015", "G015", "G015", "G015", "G015", "G016", "G057", "V105S", "GT Max", "V105S", "V105", "G057", "G057", "V105S", "V107", "G057", "V105S", "G057", "G057", "G057", "G057", "V103B", "V103B", "G015", "G057", "V105"],
        "Tyre Size": ["145 80 R12 74T", "145 80 R13 75S", "155 65 R13 73T", "155 70 R13 75T", "155 80 R13 79T", "165 65 R13 77T", "175 60 R13 77H", "175 70 R13 82H", "155 65 R14 75H", "165 65 R14 79T", "165 70 R14 81T", "165 80 R14 85T", "175 65 R14 82H", "175 70 R14 84T", "175 70 R14 84H", "185 60 R14 82H", "185 60 R14 82H", "185 65 R14 86H", "185 70 R14 88H", "185 70 R14 88H", "195 60 R14 86H", "195 60 R14 86H", "195 65 R14 89H", "195 65 R14 89H", "195 70 R14 91H", "205 60 R14 88H", "175 60 R15 81H", "175 60 R15 81H", "175 65 R15 84H", "175 65 R15 84H", "185 60 R15 84H", "185 60 R15 84H", "185 65 R15 88H", "185 65 R15 88H", "185 70 R15 89H", "195 50 R15 82V", "195 55 R15 85V", "195 60 R15 88V", "195 60 R15 88H", "195 60 R15 88H", "195 65 R15 91H", "195 65 R15 91V", "205 50 R15 86V", "205 55 R15 88V", "205 60 R15 95H", "205 65 R15 94H", "205 70 R15 96H", "205 70 R15 96H", "215 75 R15 100S", "225 60 R15 96H", "235 70 R15 103S", "235 75 R15 105T", "265 70 R15 112H", "215 75 R15 100/97S", "215 75 R15 (OWL) 100/97S", "235 75 R15 104/101S", "235 75 R15 (OWL) 104/101S", "31X10.5 R15 109S", "31X10.5 R15 109Q", "33X12.5 R15 108Q", "185 55 R16 83V", "185 60 R16 86H", "195 55 R16 87V", "195 55 R16 87V", "195 55 R16 87V", "195 55 RF16 87V", "195 60 R16 89H", "195 60 R16 89H", "205 50 R16 87V", "205 55 R16 94V", "205 55 R16 91V", "205 55 R16 94V", "205 55 R16 91V", "205 55 RF16 91W", "205 60 R16 92V", "205 60 R16 92H", "205 60 R16 92H", "205 65 R16 95H", "205 65 R16 95H", "205 65 R16 95H", "215 55 R16 97H", "215 60 R16 95H", "215 60 R16 99V", "215 60 R16 95H", "215 65 R16 98H", "215 65 R16 98H", "225 50 R16 92W", "225 50 RF16 92W", "225 55 R16 99W", "225 55 RF16 95W", "225 60 R16 98V", "235 60 R16 104V", "235 70 R16 106H", "245 75 R16 115T", "255 65 R16 109H", "275 70 R16 114H", "235 85 R16 120/116Q", "245 75 R16 120/116Q", "205 45 RF17 84V", "205 50 RF17 89W", "205 55 R17 91V", "215 45 R17 91W", "215 45 R17 91W", "215 50 R17 91V", "215 55 R17 94V", "215 55 R17 94W", "215 60 R17 96H", "215 60 R17 96H", "215 60 R17 96H", "225 45 R17 94W", "225 45 R17 91W", "225 45 RF17 91Y", "225 50 R17 94W", "225 50 RF17 94Y", "225 55 R17 101W", "225 55 R17 101W", "225 55 RF17 97Y", "225 60 R17 99H", "235 55 R17 99W", "235 55 R17 103W", "235 65 R17 108H", "235 65 R17 108V", "245 45 R17 99W", "245 65 R17 111H", "255 60 R17 106H", "265 65 R17 112H", "275 65 R17 115H", "265 65 R17 120/117Q", "265 70 R17 121/118Q", "215 55 R18 99V", "225 45 RF18 91Y", "225 50 R18 95V", "225 55 R18 98V", "235 50 R18 97V", "235 55 R18 104V", "235 60 R18 107V", "235 60 R18 107V", "245 40 RF18 93Y", "245 45 R18 100W", "245 45 RF18 96Y", "245 50 R18 100W", "245 50 RF18 100W", "255 55 R18 109W", "255 60 R18 ABH", "255 65 R18 111H", "265 60 R18 110H", "275 60 R18 113H", "285 60 R18 116H", "285 60 R18 122/119Q", "235 55 R19 105W", "245 40 RF19 94Y", "245 45 R19 98W", "255 35 R19 96Y", "255 40 R19 100Y", "255 50 R19 107W", "255 55 R19 109W", "275 35 RF19 96Y", "275 40 R19 105Y", "275 55 R19 111W", "295 30 R19 100Y", "255 50 R20 110W", "255 55 R20 110W", "275 45 R20 110W", "275 50 R20 113W", "275 40 R20 106Y", "275 45 R20 110Y", "285 50 R20 112H", "275 40 R21 107W", "295 35 R21 107Y"],
        "Type": ["TL"] * 156,
        "Consumer Price": [3130, 3660, 3890, 4020, 4340, 4070, 4680, 5120, 3970, 4790, 4130, 4420, 5570, 5530, 5630, 5400, 6200, 5850, 5400, 6040, 6030, 6220, 6220, 5740, 7360, 5870, 6570, 6350, 5860, 5960, 5970, 6060, 6210, 6300, 6300, 7290, 6480, 6880, 6770, 6950, 6940, 7050, 8160, 7320, 7850, 7380, 7430, 7070, 7180, 10430, 8520, 7980, 11020, 7720, 8470, 8920, 9860, 11900, 16140, 18280, 7500, 6760, 8340, 8490, 8520, 13350, 8130, 8280, 8880, 9100, 9250, 9260, 11330, 11930, 7750, 7870, 7890, 7530, 7650, 7670, 10740, 8450, 8620, 8640, 9540, 9130, 11580, 14440, 10920, 15760, 9510, 9700, 8980, 11940, 12070, 13170, 22260, 24050, 17600, 19870, 9440, 10080, 9990, 13090, 11620, 11820, 10200, 10440, 10490, 11630, 11640, 17520, 11760, 16540, 11470, 11680, 17730, 11440, 13550, 13640, 13080, 12500, 13250, 13630, 13580, 13890, 14220, 22710, 25160, 12440, 21190, 14340, 13780, 19330, 16340, 16000, 16310, 23300, 15790, 22040, 16340, 21690, 17530, 15000, 14170, 17740, 17790, 19550, 31610, 18700, 29470, 20790, 31200, 24810, 20430, 20230, 33720, 26160, 24400, 36710, 21300, 24680, 26190, 24960, 26320, 23920, 22000, 32420, 34110],
        "MRP": [3440, 4020, 4270, 4420, 4770, 4480, 5150, 5630, 4370, 5270, 4550, 4860, 6120, 6090, 6190, 5940, 5640, 5320, 5940, 5490, 6640, 6840, 5660, 6310, 6690, 6460, 7230, 6990, 6440, 6550, 6560, 6670, 6830, 6940, 6930, 8020, 7130, 7570, 7440, 7650, 7630, 7750, 8980, 8060, 8630, 8120, 8180, 7780, 7900, 11480, 9380, 8780, 12120, 8490, 9320, 9820, 10840, 13090, 17760, 20110, 8250, 7440, 9180, 9340, 9370, 14680, 8940, 9110, 9760, 10010, 10170, 10180, 12460, 13130, 8530, 8660, 8680, 8280, 8420, 8440, 11810, 9300, 9480, 9510, 10490, 10050, 12740, 15890, 12020, 17340, 10470, 10670, 9880, 13130, 13270, 14480, 24490, 21860, 19360, 21860, 10390, 11090, 10990, 14400, 12780, 13000, 11220, 11490, 11540, 12800, 12810, 19270, 12940, 18200, 12620, 12850, 19500, 12580, 14900, 15000, 14390, 13750, 14580, 14990, 14940, 15280, 15640, 24980, 27670, 13680, 23300, 15780, 15150, 21270, 17970, 17600, 17940, 25630, 17370, 24240, 17970, 23860, 19280, 16500, 15580, 19520, 19570, 21500, 34770, 20570, 32410, 22870, 34320, 27290, 22480, 22250, 37090, 28780, 26840, 40380, 23430, 27150, 28800, 27450, 28950, 26310, 24200, 35660, 37520]
    }

    # --- DISPLAY LOGIC ---
    def show_brand_table(title, data_dict):
        df = pd.DataFrame(data_dict)
        if search:
            mask = (df["Tyre Size"].str.contains(search, case=False)) | (df["Pattern"].str.contains(search, case=False))
            filt = df[mask]
        else: filt = df
        
        if not filt.empty:
            st.subheader(f"üè∑Ô∏è {title}")
            st.dataframe(filt, use_container_width=True, hide_index=True,
                column_config={
                    "Pattern": st.column_config.Column(width="medium"),
                    "Consumer Price": st.column_config.NumberColumn("Consumer Price (‚Çπ)", format="‚Çπ%d"),
                    "MRP": st.column_config.NumberColumn("MRP (‚Çπ)", format="‚Çπ%d")
                })
            st.markdown("---")

    # Display Tables
    show_brand_table("Bridgestone Master List", bridgestone_master)
    show_brand_table("Firestone Master List", firestone_master)
    show_brand_table("Yokohama Master List", yokohama_master)
