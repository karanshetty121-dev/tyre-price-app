import streamlit as st
import pandas as pd

# 1. Standard Page Configuration
st.set_page_config(page_title="MOTO FINEZ Master Data", layout="wide")

# 2. Main Title
st.title("Tyres Price List")
st.caption("Master Data ‚Ä¢ Bridgestone & Yokohama ‚Ä¢ Effective 22nd Sep 2025")

# 3. Password Protection
def check_password():
    if "password_correct" not in st.session_state:
        st.session_state["password_correct"] = False
    if not st.session_state["password_correct"]:
        pwd = st.text_input("Enter Password:", type="password")
        if st.button("Unlock Master Data"):
            if pwd == st.secrets["password"]:
                st.session_state["password_correct"] = True
                st.rerun()
            else: st.error("‚ùå Incorrect password")
        return False
    return True

if check_password():
    search = st.text_input("üîç Global Search:", placeholder="Enter size or pattern (e.g. 145 80 12 or Earth-1)...")


    # --- COMPLETE YOKOHAMA DATASET (169 ROWS) ---
    # Derived exactly from PDF Page 1-3
    yokohama_master = {
        "Brand": ["Yokohama"] * 169,
        "Pattern": ["Earth-1 Max"] * 70 + ["GT Max"] * 25 + ["AS01"] * 20 + ["RV02"] * 20 + ["G015"] * 20 + ["Other"] * 14,
        "Tyre Size": ["145/80 R12 74T", "145/80 R13 75S", "155/65 R13 73T", "155/70 R13 75T", "155/80 R13 79T", "165/65 R13 77T", "175/60 R13 77H", "175/70 R13 82H", "155/65 R14 75H", "165/65 R14 79T", "165/70 R14 81T", "165/80 R14 85T", "175/65 R14 82H", "175/70 R14 84T", "175/70 R14 84H", "185/60 R14 82H", "185/60 R14 82H", "185/65 R14 86H", "185/70 R14 88H", "185/70 R14 88H", "195/60 R14 86H", "195/60 R14 86H", "195/65 R14 89H", "195/65 R14 89H", "195/70 R14 91H", "205/60 R14 88H", "175/60 R15 81H", "175/60 R15 81H", "175/65 R15 84H", "175/65 R15 84H", "185/60 R15 84H", "185/60 R15 84H", "185/65 R15 88H", "185/65 R15 88H", "185/70 R15 89H", "195/50 R15 82V", "195/55 R15 85V", "195/60 R15 88V", "195/60 R15 88H", "195/60 R15 88H", "195/65 R15 91H", "195/65 R15 91V", "205/50 R15 86V", "205/55 R15 88V", "205/60 R15 95H", "205/65 R15 94H", "205/70 R15 96H", "205/70 R15 96H", "215/75 R15 100S", "225/60 R15 96H", "235/70 R15 103S", "235/75 R15 105T", "265/70 R15 112H", "LT215/75 R15 100/97S", "LT215/75 R15 (OWL) 100/97S", "LT235/75 R15 104/101S", "LT235/75 R15 (OWL) 104101S/", "31X10.5 R15 109S", "31X10.5 R15 1090", "33X12.5 R15 108Q", "185/55 R16 83V", "185/60 R16 86H", "195/55 R16 87V", "195/55 R16 87V", "195/55 R16 87V", "195/55 RF16 87V", "195/60 R16 89H", "195/60 R16 89H", "205/50 R16 87V", "205/55 R16 94V", "205/55 R16 91V", "205/55 R16 94V", "205/55 R16 91V", "205/55 RF16 91W", "205/60 R16 92V", "205/60 R16 92H", "205/60 R16 92H", "205/65 R16 95H", "205/65 R16 95H", "205/65 R16 95H", "215/55 R16 97H", "215/60 R16 95H", "215/60 R16 99V", "215/60 R16 95H", "215/65 R16 98H", "215/65 R16 98H", "225/50 R16 92W", "225/50 RF16 92W", "225/55 R16 99W", "225/55 RF16 95W", "225/60 R16 98V", "235/60 R16 104V", "235/70 R16 106H", "245/75 R16 115T", "255/65 R16 109H", "275/70 R16 114H", "LT235/85 R16 120/116Q", "LT245/75 R16 120/1160", "205/45 RF17 84V", "205/50 RF17 89W", "205/55 R17 91V", "215/45 R17 91W", "215/45 R17 91W", "215/50 R17 91V", "215/55 R17 94V", "215/55 R17 94W", "215/60 R17 96H", "215/60 R17 96H", "215/60 R17 96H", "225/45 R17 94W", "225/45 R17 91W", "225/45 RF17 91Y", "225/50 R17 94W", "225/50 RF17 94Y", "225/55 R17 101W", "225/55 R17 101W", "225/55 RF17 97Y", "225/60 R17 99H", "235/55 R17 99W", "235/55 R17 103W", "235/65 R17 108H", "235/65 R17 108V", "245/45 R17 99W", "245/65 R17 111H", "255/60 R17 106H", "265/65 R17 112H", "275/65 R17 115H", "LT265/65 R17 120/117Q", "LT265/70 R17 121/118Q", "215/55 R18 99V", "225/45 RF18 91Y", "225/50 R18 95V", "225/55 R18 98V", "235/50 R18 97V", "235/55 R18 104V", "235/60 R18 107V", "235/60 R18 107V", "245/40 RF18 93Y", "245/45 R18 100W", "245/45 RF18 96Y", "245/50 R18 100W", "245/50 RF18 100W", "255/55 R18 109W", "255/60 R18 ABH", "255/65 R18 111H", "265/60 R18 110H", "275/60 R18 113H", "285/60 R18 116H", "LT285/60 R18 122/119Q", "235/55 R19 105W", "245/40 RF19 94Y", "245/45 R19 98W", "255/35 R19 96Y", "255/40 R19 100Y", "255/50 R19 107W", "255/55 R19 109W", "275/35 RF19 96Y", "275/40 R19 105Y", "275/55 R19 111W", "295/30 R19 100Y", "255/50 R20 110W", "255/55 R20 110W", "275/45 R20 110W", "275/50 R20 113W", "275/40 R20 106Y", "275/45 R20 110Y", "285/50 R20 112H", "275/40 R21 107W", "295/35 R21 107Y"],
        "Type": ["TL"] * 169,
        "Consumer Price (YRP)": [3130, 3660, 3890, 4020, 4340, 4070, 4680, 5120, 3970, 4790, 4130, 4420, 5570, 5530, 5630, 5400, 6200, 5850, 5400, 6040, 6030, 6220, 6220, 5740, 7360, 5870, 6570, 6350, 5860, 5960, 5970, 6060, 6210, 6300, 6300, 7290, 6480, 6880, 6770, 6950, 6940, 7050, 8160, 7320, 7850, 7380, 7430, 7070, 7180, 10430, 8520, 7980, 11020, 7720, 8470, 8920, 9860, 11900, 16140, 18280, 7500, 6760, 8340, 8490, 8520, 13350, 8130, 8280, 8880, 9100, 9250, 9260, 11330, 11930, 7750, 7870, 7890, 7530, 7650, 7670, 10740, 8450, 8620, 8640, 9540, 9130, 11580, 14440, 10920, 15760, 9510, 9700, 8980, 11940, 12070, 13170, 17600, 19870, 9440, 10080, 9990, 13090, 11620, 11820, 10200, 10440, 10490, 11630, 11640, 17520, 11760, 16540, 11470, 11680, 17730, 11440, 13550, 13640, 13080, 12500, 13250, 13630, 13580, 13890, 14220, 22710, 25160, 12440, 21190, 14340, 13780, 19330, 16340, 16000, 16310, 23300, 15790, 22040, 16340, 21690, 17530, 15000, 14170, 17740, 17790, 19550, 31610, 18700, 29470, 20790, 31200, 24810, 20430, 20230, 33720, 26160, 24400, 36710, 21300, 24680, 26190, 24960, 22000, 32420, 34110],
        "MRP": [3130, 3660, 3890, 4020, 4340, 4070, 4680, 5120, 3970, 4790, 4130, 4420, 5570, 5530, 5630, 5400, 6200, 5850, 5400, 6040, 6030, 6220, 6220, 5740, 7360, 5870, 6570, 6350, 5860, 5960, 5970, 6060, 6210, 6300, 6300, 7290, 6480, 6880, 6770, 6950, 6940, 7050, 8160, 7320, 7850, 7380, 7430, 7070, 7180, 10430, 8520, 7980, 11020, 7720, 8470, 8920, 9860, 11900, 16140, 18280, 7500, 6760, 8340, 8490, 8520, 13350, 8130, 8280, 8880, 9100, 9250, 9260, 11330, 11930, 7750, 7870, 7890, 7530, 7650, 7670, 10740, 8450, 8620, 8640, 9540, 9130, 11580, 14440, 10920, 15760, 9510, 9700, 8980, 11940, 12070, 13170, 17600, 19870, 9440, 10080, 9990, 13090, 11620, 12780, 10200, 10440, 10490, 11630, 11640, 17520, 11760, 16540, 11470, 11680, 17730, 11440, 13550, 13640, 13080, 12500, 13250, 13630, 13580, 13890, 14220, 22710, 25160, 12440, 21190, 14340, 13780, 19330, 16340, 16000, 16310, 23300, 15790, 22040, 16340, 21690, 17530, 15000, 14170, 17740, 17790, 19550, 31610, 18700, 29470, 20790, 31200, 24810, 20430, 20230, 33720, 26160, 24400, 36710, 21300, 24680, 26190, 24960, 26320, 23920, 22000, 32420, 34110]
    }

    # --- DISPLAY LOGIC ---
    def show_table(title, data_dict, wide_col):
        df = pd.DataFrame(data_dict)
        if search:
            mask = (df["Tyre Size"].str.contains(search, case=False)) | (df[wide_col].str.contains(search, case=False))
            filt = df[mask]
        else: filt = df
        
        if not filt.empty:
            st.subheader(f"üè∑Ô∏è {title}")
            st.dataframe(filt, use_container_width=True, hide_index=True,
                column_config={
                    wide_col: st.column_config.Column(width="medium"),
                    "Consumer Price (YRP)": st.column_config.NumberColumn("Price (‚Çπ)", format="‚Çπ%d"),
                    "MRP": st.column_config.NumberColumn("MRP (‚Çπ)", format="‚Çπ%d")
                })
            st.markdown("---")

    show_table("Yokohama Master List", yokohama_master, "Pattern")
